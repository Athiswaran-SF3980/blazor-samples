@page "/pdf/auto-tag"
@using System.IO
@using Syncfusion.Blazor.Buttons
@*Hidden:Lines*@
@inherits SampleBaseComponent

@using Blazor_MAUI_Demos 
@using Blazor_MAUI_Demos.Services

@*End:Hidden*@
@*Hidden:Lines*@
@inject NavigationManager NavigationManager


@*End:Hidden*@

<SampleDescription>
    <p style="font-size:16px">This sample demonstrates how to create tagged PDF or accessible PDF from the scratch using auto tag feature. The auto tag feature will tag the document based on PDF element created in the document.</p>
</SampleDescription>
<ActionDescription>
   <p style="font-size:16px">This feature can be used for the people who require assistive technologies when the electronic content is ready. The Essential PDF supports creating tagged PDF with Section 508 compliant. More information about the tagged PDF can be found in this documentation <a target='_blank'
href='https://help.syncfusion.com/file-formats/pdf/working-with-tagged-pdf?_ga=2.212929108.1703522802.1584005056-1302582622.1556169414' aria-label="documentation section">section.</a></p>
</ActionDescription>

<div class="control-section">
    <p style="font-size:16px">Click the button to view a PDF document generated by Essential PDF. Please note that Adobe Reader or its equivalent is required to view the resultant document. </p>
    <div style="font-size:16px">
        <span id="label1">Accessibility Level: </span>
        <span style="margin-left: 10px">
            <SfRadioButton Label="PDF/UA-1" Name="AccessibilityLevel" Value=@("PDF_UA_1") @bind-Checked="@AccessibilityLevel"></SfRadioButton>
        </span>
        <span style="margin-left: 20px">
            <SfRadioButton Label="PDF/UA-2" Name="AccessibilityLevel" Value=@("PDF_UA_2") @bind-Checked="@AccessibilityLevel"></SfRadioButton>
        </span>
        <span style="margin-left: 20px">
            <SfRadioButton Label="Well Tagged PDF" Name="AccessibilityLevel" Value=@("WTPDF") @bind-Checked="@AccessibilityLevel"></SfRadioButton>
        </span>
    </div>
   
    <div class="button-section">
        <div id="button-control">
            <div class="row">
                <div>
                    <SfButton @onclick="GeneratePDF">Create Tag</SfButton>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .radio-control {
        margin: 0 0 5% 0;
    }    

    .control-section .row {
        margin: 10px 0;
    }
</style>

@code {
    string AccessibilityLevel = "PDF_UA_1";
    
    /// <summary>
    /// Create and download the simple PDF document
    /// </summary>
    public async void GeneratePDF(MouseEventArgs args)
    {	   
        Dictionary<string, MemoryStream> fileData = new Dictionary<string, MemoryStream>();
        fileData.Add("auto-tag.jpg", await ReadData("wwwroot/data/pdf/auto-tag.jpg"));      
        fileData.Add("arial.ttf", await ReadData("wwwroot/data/pdf/arial.ttf"));       
        fileData.Add("autotag-small.jpg", await ReadData("wwwroot/data/pdf/autotag-small.jpg"));
        AutotagService service = new AutotagService(fileData);        
        MemoryStream documentStream = service.CreatePdfDocument(AccessibilityLevel);
        service.Close();
        string fileName = AccessibilityLevel == "WTPDF" ? "WTPDF.pdf" : "Autotag.pdf";
        SaveService saveService = new SaveService();
        saveService.SaveAndView(fileName, "application/pdf", documentStream);            
    }
    private async Task<MemoryStream> ReadData(string fileName)
    {
        using var stream = await FileSystem.OpenAppPackageFileAsync(fileName);
        MemoryStream memoryStream = new MemoryStream();
        await stream.CopyToAsync(memoryStream);
        memoryStream.Position = 0;
        return memoryStream;
    }
}